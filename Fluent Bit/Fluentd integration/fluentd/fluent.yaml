system:
  log_level: info

config:
  - source:
      $type: forward
      port: 24224
      bind: 0.0.0.0

  - match:
      $tag: "**"
      $type: copy
      stores:
        - $type: stdout

        - $type: azure-storage-append-blob
          azure_storage_account: "#{ENV['AZURE_STORAGE_ACCOUNT']}"
          azure_storage_access_key: "#{ENV['AZURE_STORAGE_ACCESS_KEY']}"
          azure_container: "#{ENV['AZURE_CONTAINER'] || 'logs'}"
          auto_create_container: true
          path: logs/
          azure_object_key_format: "%{path}%{time_slice}_%{index}.log"
          time_slice_format: "%Y%m%d-%H"
          buffer:
            $type: file
            path: /var/log/fluent/buffer
            timekey: 120
            timekey_wait: 30
            timekey_use_utc: true
